## Совместное использование (sharing)

При работе с состояниями возникает ряд тонких моментов, которые обязательно подлежат формализации. Это, прежде всего, понятие равенства ячеек. **Можно ли считать, что две ячейки равны, если равно их содержание?** А если два идентификатора X и Y ссылаются на одну и ту же ячейку? Такой случай называется  **совместное использование (sharing) или альясинг (aliasing)** , а подобные идентификаторы называют **алиасы** (термин, активно использующися в ИТ). Изменение содержимого X автоматически влечёт изменение содержимого Y, так как их содержимое на самом деле физически одно. Этот момент в ООП называется  **передача объекта по ссылке** .

Когда алиасов ячейки много, понимание программы сразу существенно усложняется. **Решается данная проблема инкапсуляцией состояния** -- выделением всей логики работы с состоянием в небольшую и чётко определённую часть программы и определёнными гарантиями, что оно не сможет оттуда выбраться. Это одна из ключевых причин, по которой абстрактные типы данных -- особенно хорошая идея при использовании явных состояний, которые инкапсулируются в АТД и скрываются за набором корректных высокоуровневых операций.


## Как сравнивать значения ячеек?

Два значения в декларативной модели считаются равными, если они структурно эквивалентны, и значения всех полей в их структуре все равны друг другу:

```
X = person(age:25, name:"Petya")
Y = person(age:25, name:"Petya")
```

Значение X будет равно значению Y.Однако в случае ячеек ситуация будет другая. Например, код

```
NewCell(X, 10)
NewCell(Y, 10)
```

создаёт две ячейки X и Y, каждая из которых хранит значение 10 (X и Y не алиасы), однако  **ячейки X и Y считаются не равны друг другу** .

Схема проверки равенства ячеек называется  **эквивалентность токенов** .

**Равенство (эквивалентность) ячеек подразумевает, что при изменении содержимого одной ячейки изменится и содержимое другой ячейки -- фактически, "равные" ячейки просто должны быть алиасами** .

Конечно, проверка равенства содержимого неэквивалентных ячеек вполне возможна:

```
@X == @Y
```

Но в целом, это просто совпадение; такое равенство очевидно не обязательно должно оставаться верным на протяжении работы всей программы, так как содержимое ячеек может меняться.


### Сравнение и совместное использование ячеек (задания)

======= 15. Шаринг -- это ...

[ ] совместное использование одного имени ячейки

[] совместное использование одной ячейки

[1 ] совместное использование содержимого одной ячейки

======= 16. Алиас -- это ...

[ 1] ссылка нескольких идетификаторов на содержимое одной ячейки

[ ] передача объектов по ссылке

[ ] передача объектов по имени

======= 17. Две ячейки равны, если ...

[ ] равны их значения

[ ] равны их структуры

[1 ] они -- алиасы
